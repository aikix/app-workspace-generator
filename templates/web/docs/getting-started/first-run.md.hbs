# First Run Setup

This guide walks you through the initial configuration of {{projectName}} after installation.

## Overview

First-time setup involves:
{{#if (eq backend "firebase")}}1. Firebase project configuration
2. {{else}}1. {{/if}}Environment variables setup
{{#if (eq backend "firebase")}}3. {{else}}2. {{/if}}Development server verification
{{#if (eq backend "firebase")}}4. {{else}}3. {{/if}}Initial data setup (if applicable)

{{#if (eq backend "firebase")}}
## Step 1: Firebase Setup

### 1.1 Create Firebase Project

If you haven't already:

1. Go to https://console.firebase.google.com/
2. Click "Add project" or select existing project
3. Follow the setup wizard:
   - Enter project name
   - Enable Google Analytics (optional)
   - Accept terms

### 1.2 Register Web App

1. In Firebase Console, click the web icon (`</>`) to add a web app
2. Enter app nickname (e.g., "{{projectName}} Web")
3. **Do not** enable Firebase Hosting yet (optional for later)
4. Click "Register app"

### 1.3 Get Firebase Configuration

After registering, you'll see your Firebase config object:

```javascript
const firebaseConfig = {
  apiKey: "AIza...",
  authDomain: "your-project.firebaseapp.com",
  projectId: "your-project",
  storageBucket: "your-project.appspot.com",
  messagingSenderId: "123456789",
  appId: "1:123456789:web:abc123"
};
```

### 1.4 Enable Firebase Services

Enable the services you'll use:

#### **Authentication**
1. Navigate to **Authentication** > **Sign-in method**
2. Enable desired providers:
   - Email/Password
   - Google
   - GitHub
   - Others as needed

#### **Firestore Database**
1. Navigate to **Firestore Database**
2. Click **Create database**
3. Choose mode:
   - **Production mode**: Use provided security rules
   - **Test mode**: Open access (change rules before deploying!)
4. Select region (choose closest to your users)

#### **Cloud Storage**
1. Navigate to **Storage**
2. Click **Get started**
3. Choose security rules mode
4. Select storage location

### 1.5 Configure Environment Variables

Update `.env.local` with your Firebase credentials:

```env
# Firebase Client Configuration
NEXT_PUBLIC_FIREBASE_API_KEY=your_api_key_here
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id
```

{{#if (eq firebasePattern "server-first")}}
### 1.6 Configure Firebase Admin SDK

For server-side operations, you need a service account:

1. Go to **Project Settings** > **Service Accounts**
2. Click **Generate new private key**
3. Download the JSON file
4. Extract the required values and add to `.env.local`:

```env
# Firebase Admin SDK (Server-side)
FIREBASE_PROJECT_ID=your_project_id
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour_Private_Key_Here\n-----END PRIVATE KEY-----\n"
```

**Security Note**: Never commit `.env.local` or service account JSON files to version control!

### 1.7 Set Up Firestore Security Rules

Copy the provided rules to Firebase:

1. In Firebase Console, go to **Firestore Database** > **Rules**
2. Copy contents from `firestore.rules` in your project
3. Click **Publish**

Review and customize rules based on your security requirements.

### 1.8 Set Up Storage Security Rules

1. In Firebase Console, go to **Storage** > **Rules**
2. Copy contents from `storage.rules` in your project
3. Click **Publish**

### 1.9 Optional: Set Up Firestore Indexes

For complex queries, add indexes:

1. Go to **Firestore Database** > **Indexes**
2. Import from `firestore.indexes.json`:
   ```bash
   firebase deploy --only firestore:indexes
   ```
   Or manually create indexes as needed

{{/if}}
{{/if}}

## Step {{#if (eq backend "firebase")}}2{{else}}1{{/if}}: Verify Environment Configuration

Check that all required environment variables are set:

```bash
# View your current environment
{{#if (eq packageManager "npm")}}npm run dev{{else if (eq packageManager "yarn")}}yarn dev{{else if (eq packageManager "pnpm")}}pnpm dev{{else}}bun dev{{/if}}
```

If you see errors about missing environment variables, review `.env.local` and ensure all required variables are defined.

## Step {{#if (eq backend "firebase")}}3{{else}}2{{/if}}: Start Development Server

```bash
{{#if (eq packageManager "npm")}}npm run dev{{else if (eq packageManager "yarn")}}yarn dev{{else if (eq packageManager "pnpm")}}pnpm dev{{else}}bun dev{{/if}}
```

**Expected output**:
```
▲ Next.js 16.x.x
- Local:        http://localhost:3000
- Network:      http://192.168.x.x:3000

✓ Ready in Xs
```

Open http://localhost:3000 in your browser.

### What You Should See

- ✅ Homepage loads without errors
- ✅ No console errors in browser DevTools{{#if (eq styling "tailwind")}}
- ✅ Tailwind CSS styles are applied{{/if}}{{#if (eq backend "firebase")}}
- ✅ Firebase connection is established (check network tab){{/if}}

{{#if (eq backend "firebase")}}
## Step 4: Test Firebase Connection

### 4.1 Test Authentication

1. Navigate to the login/signup page
2. Try creating a test account
3. Verify user appears in Firebase Console > Authentication

### 4.2 Test Firestore

1. Perform a write operation (e.g., create a post)
2. Check Firebase Console > Firestore Database
3. Verify data appears correctly

### 4.3 Test Storage

1. Try uploading a file
2. Check Firebase Console > Storage
3. Verify file is stored

{{#if (eq firebasePattern "server-first")}}
### 4.4 Test Server-Side Operations

1. Try a server action or API route
2. Check server logs for Firebase Admin SDK operations
3. Verify session management works

{{/if}}
{{/if}}

## Step {{#if (eq backend "firebase")}}5{{else}}3{{/if}}: Configure Git

### Initialize Git (if not already done)

```bash
git init
git add .
git commit -m "chore: initial setup"
```

### Set Up Git Remotes

```bash
git remote add origin <your-repository-url>
git push -u origin main
```

{{#if gitHooks}}
### Verify Git Hooks

Git hooks are managed by Husky. Verify they're working:

```bash
# Try making a commit with invalid message
git commit --allow-empty -m "bad commit"
# Should fail due to commitlint

# Try making a commit with valid message
git commit --allow-empty -m "chore: test commit"
# Should succeed
```
{{/if}}

## Step {{#if (eq backend "firebase")}}6{{else}}4{{/if}}: Run Initial Tests

{{#if (eq testing "playwright")}}
### E2E Tests

Run Playwright tests to verify everything works:

```bash
{{#if (eq packageManager "npm")}}npm run e2e{{else if (eq packageManager "yarn")}}yarn e2e{{else if (eq packageManager "pnpm")}}pnpm e2e{{else}}bun e2e{{/if}}
```

**Expected result**: All tests should pass (or at least run without errors)

View test report:
```bash
npx playwright show-report
```
{{/if}}

{{#if linting}}
### Linting

Verify code quality:

```bash
{{#if (eq packageManager "npm")}}npm run lint{{else if (eq packageManager "yarn")}}yarn lint{{else if (eq packageManager "pnpm")}}pnpm lint{{else}}bun lint{{/if}}
```

**Expected result**: No linting errors
{{/if}}

{{#if typescript}}
### Type Checking

Verify TypeScript types:

```bash
{{#if (eq packageManager "npm")}}npm run type-check{{else if (eq packageManager "yarn")}}yarn type-check{{else if (eq packageManager "pnpm")}}pnpm type-check{{else}}bun type-check{{/if}}
```

**Expected result**: No type errors
{{/if}}

## Step {{#if (eq backend "firebase")}}7{{else}}5{{/if}}: Build for Production

Test that your project builds successfully:

```bash
{{#if (eq packageManager "npm")}}npm run build{{else if (eq packageManager "yarn")}}yarn build{{else if (eq packageManager "pnpm")}}pnpm build{{else}}bun run build{{/if}}
```

**Expected output**:
```
✓ Creating an optimized production build
✓ Compiled successfully
✓ Linting and checking validity of types
✓ Collecting page data
✓ Generating static pages (X/X)
✓ Finalizing page optimization

Route (app)                                Size
...
✓ Build completed
```

## Troubleshooting First Run

{{#if (eq backend "firebase")}}
### Firebase Connection Issues

**Error**: "Firebase: Error (auth/invalid-api-key)"
- **Solution**: Double-check your `NEXT_PUBLIC_FIREBASE_API_KEY` in `.env.local`

**Error**: "Firebase: Error (auth/project-not-found)"
- **Solution**: Verify `NEXT_PUBLIC_FIREBASE_PROJECT_ID` matches your Firebase project

**Error**: "Firebase: Error (auth/unauthorized-domain)"
- **Solution**: Add `localhost:3000` to authorized domains in Firebase Console > Authentication > Settings

{{/if}}
### Build Errors

**Error**: "Module not found"
- **Solution**: Run `{{#if (eq packageManager "npm")}}npm install{{else if (eq packageManager "yarn")}}yarn install{{else if (eq packageManager "pnpm")}}pnpm install{{else}}bun install{{/if}}` again

**Error**: "Port 3000 already in use"
- **Solution**: Kill the process or use a different port: `{{#if (eq packageManager "npm")}}npm run dev -- -p 3001{{else if (eq packageManager "yarn")}}yarn dev -p 3001{{else if (eq packageManager "pnpm")}}pnpm dev -p 3001{{else}}bun dev -p 3001{{/if}}`

### Environment Variable Issues

If environment variables aren't loading:
1. Ensure `.env.local` exists in project root
2. Restart the development server
3. Check for typos in variable names (must start with `NEXT_PUBLIC_` for client-side)

## Next Steps

Your project is now fully set up! Continue with:

1. **Development workflow**: [development.md](./development.md)
2. **Debugging guide**: [debugging.md](./debugging.md)
3. **Start building features!**

## Quick Reference

```bash
# Start development server
{{#if (eq packageManager "npm")}}npm run dev{{else if (eq packageManager "yarn")}}yarn dev{{else if (eq packageManager "pnpm")}}pnpm dev{{else}}bun dev{{/if}}

# Build for production
{{#if (eq packageManager "npm")}}npm run build{{else if (eq packageManager "yarn")}}yarn build{{else if (eq packageManager "pnpm")}}pnpm build{{else}}bun run build{{/if}}

# Run linter
{{#if (eq packageManager "npm")}}npm run lint{{else if (eq packageManager "yarn")}}yarn lint{{else if (eq packageManager "pnpm")}}pnpm lint{{else}}bun lint{{/if}}

{{#if (eq testing "playwright")}}# Run E2E tests
{{#if (eq packageManager "npm")}}npm run e2e{{else if (eq packageManager "yarn")}}yarn e2e{{else if (eq packageManager "pnpm")}}pnpm e2e{{else}}bun e2e{{/if}}
{{/if}}
```
